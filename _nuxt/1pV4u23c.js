import{g as P,j as C,o as n,r as _,k as D,c as a,p as N,l as $,m as L,n as F,q as V,s as K,v as W,a as s,x as k,F as x,y as z,t as m,z as Z,b as q,A as Y,B as G,C as H,w as J,D as Q}from"./oMxLijh5.js";const U=P({__name:"EmojiPicker",emits:["emoji-select"],setup(T,{emit:r}){const o=r;function d(i){o("emoji-select",i.detail.unicode)}return(i,h)=>{const f=U;return n(),C(f,{onEmojiClick:d})}}}),X=Symbol.for("nuxt:client-only"),ee=P({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(T,{slots:r,attrs:o}){const d=_(!1);return D(()=>{d.value=!0}),N(X,!0),i=>{var v;if(d.value)return(v=r.default)==null?void 0:v.call(r);const h=r.fallback||r.placeholder;if(h)return h();const f=i.fallback||i.placeholder||"",j=i.fallbackTag||i.placeholderTag||"span";return a(j,o,f)}}}),te={key:0,class:"chatPage"},ne={class:"messageList"},ae={class:"msgOutboxContent"},oe={key:0,class:"filePreview"},le=["src"],se=["href"],ie={class:"timestampOutbox"},ce={class:"msgInboxContent"},re={key:0,class:"filePreview"},ue=["src"],de=["href"],fe={class:"timestampInbox"},me={key:0,class:"filePreview"},_e=["src"],pe={key:1},he={class:"sendMsgCont"},ve=["onKeydown"],ke=P({__name:"[chatId]",setup(T){$().push("/chat");const o=_(null),d=_(null),i=_(null),h=L(()=>o.value?(window.URL||window.webkitURL).createObjectURL(o.value):void 0),f=F(),v=V().params.chatId,p=_(""),g=_(!1),I=_(!1),w=L(()=>f.selectChatById(v)??null);D(async()=>{w.value||await f.fetchData(),await K(()=>import("./DUTOXKKD.js"),[],import.meta.url),I.value=!0});function B(l){const t=l.detail.emoji;p.value+=t}function S(l){let t=new Date(l);if(isNaN(t.getTime())){const y=l.replace(/(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}):(\d{2})\.(\d{3})Z$/,"$1:59.$3Z");t=new Date(y)}if(isNaN(t.getTime()))return"";t.getSeconds()>59&&t.setSeconds(59);const u=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),c=t.getDate(),b=t.toLocaleString("default",{month:"long"}),e=t.getFullYear();return`${c} ${b} ${e}-${u}`}function A(){var c;if(!p.value.trim()&&!o.value)return;const l=p.value.trim(),t=typeof window<"u"&&o.value?URL.createObjectURL(o.value):null,u=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():Date.now().toString();f.updateChat({chatId:v,newMessages:[{id:u,content:l,file:t??void 0,fileType:((c=o.value)==null?void 0:c.type)??void 0,isInbox:!1,sentAt:new Date().toISOString()}]}),p.value="",g.value=!1,o.value=null}function E(){var l;(l=d.value)==null||l.click()}function M(l){var c;const u=((c=l.target.files)==null?void 0:c[0])??null;u&&(o.value=u)}function O(){g.value=!g.value}return(l,t)=>{const u=U,c=ee,b=W("IndexPage");return n(),a("div",null,[w.value?(n(),a("div",te,[s("ul",ne,[(n(!0),a(x,null,z(w.value.messages,e=>{var y,R;return n(),a("li",{key:e.id,class:Q([e.isInbox?"outbox":"inbox"])},[e.isInbox?(n(),a(x,{key:0},[t[1]||(t[1]=s("span",{class:"ownerName"},"Radu Bogdan",-1)),s("span",ae,m(e.content),1),e.file?(n(),a("span",oe,[(y=e.fileType)!=null&&y.startsWith("image/")?(n(),a("img",{key:0,src:e.file,alt:"Preview",class:"imagePreview"},null,8,le)):(n(),a("a",{key:1,href:e.file,target:"_blank"},m(e.file),9,se))])):k("",!0),s("span",ie,m(e.sentAt?S(e.sentAt):"Time not available"),1)],64)):(n(),a(x,{key:1},[s("span",ce,m(e.content),1),e.file?(n(),a("span",re,[(R=e.fileType)!=null&&R.startsWith("image/")?(n(),a("img",{key:0,src:e.file,alt:"Preview",class:"imagePreview"},null,8,ue)):(n(),a("a",{key:1,href:e.file,target:"_blank"},m(e.file),9,de))])):k("",!0),s("span",fe,m(e.sentAt?S(e.sentAt):"Time not available"),1)],64))],2)}),128)),o.value?(n(),a("li",me,[o.value.type.startsWith("image/")?(n(),a("img",{key:0,src:h.value,alt:"File Preview",class:"imagePreview"},null,8,_e)):(n(),a("span",pe,m(o.value.name),1))])):k("",!0)]),s("div",he,[Z(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),type:"text",placeholder:"Type something here...",class:"sendMsgInput",onKeydown:G(H(A,["prevent"]),["enter"])},null,40,ve),[[Y,p.value]]),s("button",{type:"button",class:"writeMsgButton",onClick:E},t[2]||(t[2]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"var(--Text-color)",width:"18",height:"18",viewBox:"0 0 24 24"},[s("path",{d:"M16.5 6a3 3 0 0 0-4.15 0L7 11.4a1.75 1.75 0 0 0 2.46 2.46l4.95-4.95a1.25 1.25 0 1 1 1.76 1.76l-5.65 5.66a3.75 3.75 0 1 1-5.3-5.3L11.2 5.1a5 5 0 0 1 7.08 7.07l-6.3 6.3a6.25 6.25 0 0 1-8.83-8.83l7.2-7.2a3.75 3.75 0 0 1 5.3 5.3L9.25 15.3"})],-1)])),s("input",{type:"file",class:"hidden",ref_key:"fileInputRef",ref:d,onChange:M},null,544),s("button",{type:"button",class:"emojiButton",onClick:O}," ðŸ˜Š "),q(c,null,{default:J(()=>[I.value?(n(),C(u,{key:0,ref_key:"emojiPickerRef",ref:i,style:{position:"absolute",bottom:"55px",right:"15px"},onEmojiClick:B},null,512)):k("",!0)]),_:1})])])):(n(),C(b,{key:1}))])}}});export{ke as default};
