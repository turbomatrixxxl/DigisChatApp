import{g as T,j as g,o as s,r as u,k as P,l as M,m as $,n as A,p as N,c as o,a as i,q as v,F as y,s as F,t as c,v as O,x as V,y as K,z as W,A as z}from"./CFl0S_xl.js";import Z from"./Pubx3UjG.js";const I=T({__name:"EmojiPicker",emits:["emoji-select"],setup(L,{emit:n}){const d=n;function h(f){d("emoji-select",f.detail.unicode)}return(f,m)=>{const b=I;return s(),g(b,{onEmojiClick:h})}}}),q={key:0,class:"chatPage"},Y={class:"messageList"},G={class:"msgOutboxContent"},H={key:0,class:"filePreview"},J=["src"],Q=["href"],X={class:"timestampOutbox"},ee={class:"msgInboxContent"},te={key:0,class:"filePreview"},se=["src"],oe=["href"],ne={class:"timestampInbox"},ae={key:0,class:"filePreview"},ie=["src"],le={key:1},ce={class:"sendMsgCont"},re=["onKeydown"],fe=T({__name:"[chatId]",setup(L){const n=u(null),d=u(null),h=u(null),f=P(()=>n.value?(window.URL||window.webkitURL).createObjectURL(n.value):void 0),m=M(),x=$().params.chatId,r=u(""),w=u(!1),j=u(!1),k=P(()=>m.selectChatById(x));A(async()=>{k.value||await m.fetchData(),await N(()=>import("./DUTOXKKD.js"),[],import.meta.url),j.value=!0});function R(a){const t=a.detail.emoji;r.value+=t}function C(a){let t=new Date(a);if(isNaN(t.getTime())){const E=a.replace(/(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}):(\d{2})\.(\d{3})Z$/,"$1:59.$3Z");t=new Date(E)}if(isNaN(t.getTime()))return"";t.getSeconds()>59&&t.setSeconds(59);const l=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e=t.getDate(),_=t.toLocaleString("default",{month:"long"}),p=t.getFullYear();return`${e} ${_} ${p}-${l}`}function S(){var l;if(!r.value.trim()&&!n.value)return;const a=r.value.trim(),t=n.value?(window.URL||window.webkitURL).createObjectURL(n.value):null;m.updateChat({chatId:x,newMessages:[{id:crypto.randomUUID(),content:a,file:t??void 0,fileType:((l=n.value)==null?void 0:l.type)??void 0,isInbox:!1,sentAt:new Date().toISOString()}]}),r.value="",w.value=!1,n.value=null}function U(){var a;(a=d.value)==null||a.click()}function B(a){var e;const l=((e=a.target.files)==null?void 0:e[0])??null;l&&(n.value=l)}function D(){w.value=!w.value}return(a,t)=>{const l=I;return k.value?(s(),o("div",q,[i("ul",Y,[(s(!0),o(y,null,F(k.value.messages,e=>{var _,p;return s(),o("li",{key:e.id,class:z([e.isInbox?"outbox":"inbox"])},[e.isInbox?(s(),o(y,{key:0},[t[1]||(t[1]=i("span",{class:"ownerName"},"Radu Bogdan",-1)),i("span",G,c(e.content),1),e.file?(s(),o("span",H,[(_=e.fileType)!=null&&_.startsWith("image/")?(s(),o("img",{key:0,src:e.file,alt:"Preview",class:"imagePreview"},null,8,J)):(s(),o("a",{key:1,href:e.file,target:"_blank"},c(e.file),9,Q))])):v("",!0),i("span",X,c(e.sentAt?C(e.sentAt):"Time not available"),1)],64)):(s(),o(y,{key:1},[i("span",ee,c(e.content),1),e.file?(s(),o("span",te,[(p=e.fileType)!=null&&p.startsWith("image/")?(s(),o("img",{key:0,src:e.file,alt:"Preview",class:"imagePreview"},null,8,se)):(s(),o("a",{key:1,href:e.file,target:"_blank"},c(e.file),9,oe))])):v("",!0),i("span",ne,c(e.sentAt?C(e.sentAt):"Time not available"),1)],64))],2)}),128)),n.value?(s(),o("li",ae,[n.value.type.startsWith("image/")?(s(),o("img",{key:0,src:f.value,alt:"File Preview",class:"imagePreview"},null,8,ie)):(s(),o("span",le,c(n.value.name),1))])):v("",!0)]),i("div",ce,[O(i("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),type:"text",placeholder:"Type something here...",class:"sendMsgInput",onKeydown:K(W(S,["prevent"]),["enter"])},null,40,re),[[V,r.value]]),i("button",{type:"button",class:"writeMsgButton",onClick:U},t[2]||(t[2]=[i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"var(--Text-color)",width:"18",height:"18",viewBox:"0 0 24 24"},[i("path",{d:"M16.5 6a3 3 0 0 0-4.15 0L7 11.4a1.75 1.75 0 0 0 2.46 2.46l4.95-4.95a1.25 1.25 0 1 1 1.76 1.76l-5.65 5.66a3.75 3.75 0 1 1-5.3-5.3L11.2 5.1a5 5 0 0 1 7.08 7.07l-6.3 6.3a6.25 6.25 0 0 1-8.83-8.83l7.2-7.2a3.75 3.75 0 0 1 5.3 5.3L9.25 15.3"})],-1)])),i("input",{type:"file",class:"hidden",ref_key:"fileInputRef",ref:d,onChange:B},null,544),i("button",{type:"button",class:"emojiButton",onClick:D}," ðŸ˜Š "),j.value?(s(),g(l,{key:0,ref_key:"emojiPickerRef",ref:h,style:{position:"absolute",bottom:"55px",right:"15px"},onEmojiClick:R},null,512)):v("",!0)])])):(s(),g(Z,{key:1}))}}});export{fe as default};
