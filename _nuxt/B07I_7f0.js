import{g as L,r as c,j as k,k as U,l as S,m as B,c as s,o as n,n as D,a,p as h,F as v,q as R,t as r,s as M,v as N,x as $,y as j,z as A}from"./DvLlDlk1.js";const F={key:0,class:"chatPage"},O={class:"messageList"},E={class:"msgOutboxContent"},K={key:0,class:"filePreview"},V=["src"],W=["href"],z={class:"timestampOutbox"},Z={class:"msgInboxContent"},q={key:0,class:"filePreview"},Y=["src"],G=["href"],H={class:"timestampInbox"},J={key:0,class:"filePreview"},Q=["src"],X={key:1},ee={class:"sendMsgCont"},te=["onKeydown"],oe=L({__name:"[chatId]",setup(ne){const o=c(null),m=c(null);c(null);const b=k(()=>o.value?(window.URL||window.webkitURL).createObjectURL(o.value):void 0),_=U(),y=S().params.chatId,u=c(""),p=c(!1);c(!1);const w=k(()=>_.selectChatById(y)??null);function g(l){let t=new Date(l);if(isNaN(t.getTime())){const T=l.replace(/(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}):(\d{2})\.(\d{3})Z$/,"$1:59.$3Z");t=new Date(T)}if(isNaN(t.getTime()))return"";t.getSeconds()>59&&t.setSeconds(59);const i=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e=t.getDate(),d=t.toLocaleString("default",{month:"long"}),f=t.getFullYear();return`${e} ${d} ${f}-${i}`}function x(){var e;if(!u.value.trim()&&!o.value)return;const l=u.value.trim(),t=typeof window<"u"&&o.value?URL.createObjectURL(o.value):null,i=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():Date.now().toString();_.updateChat({chatId:y,newMessages:[{id:i,content:l,file:t??void 0,fileType:((e=o.value)==null?void 0:e.type)??void 0,isInbox:!1,sentAt:new Date().toISOString()}]}),u.value="",p.value=!1,o.value=null}function C(){var l;(l=m.value)==null||l.click()}function I(l){var e;const i=((e=l.target.files)==null?void 0:e[0])??null;i&&(o.value=i)}function P(){p.value=!p.value}return(l,t)=>{const i=B("IndexPage");return n(),s("div",null,[w.value?(n(),s("div",F,[a("ul",O,[(n(!0),s(v,null,R(w.value.messages,e=>{var d,f;return n(),s("li",{key:e.id,class:A([e.isInbox?"outbox":"inbox"])},[e.isInbox?(n(),s(v,{key:0},[t[1]||(t[1]=a("span",{class:"ownerName"},"Radu Bogdan",-1)),a("span",E,r(e.content),1),e.file?(n(),s("span",K,[(d=e.fileType)!=null&&d.startsWith("image/")?(n(),s("img",{key:0,src:e.file,alt:"Preview",class:"imagePreview"},null,8,V)):(n(),s("a",{key:1,href:e.file,target:"_blank"},r(e.file),9,W))])):h("",!0),a("span",z,r(e.sentAt?g(e.sentAt):"Time not available"),1)],64)):(n(),s(v,{key:1},[a("span",Z,r(e.content),1),e.file?(n(),s("span",q,[(f=e.fileType)!=null&&f.startsWith("image/")?(n(),s("img",{key:0,src:e.file,alt:"Preview",class:"imagePreview"},null,8,Y)):(n(),s("a",{key:1,href:e.file,target:"_blank"},r(e.file),9,G))])):h("",!0),a("span",H,r(e.sentAt?g(e.sentAt):"Time not available"),1)],64))],2)}),128)),o.value?(n(),s("li",J,[o.value.type.startsWith("image/")?(n(),s("img",{key:0,src:b.value,alt:"File Preview",class:"imagePreview"},null,8,Q)):(n(),s("span",X,r(o.value.name),1))])):h("",!0)]),a("div",ee,[M(a("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),type:"text",placeholder:"Type something here...",class:"sendMsgInput",onKeydown:$(j(x,["prevent"]),["enter"])},null,40,te),[[N,u.value]]),a("button",{type:"button",class:"writeMsgButton",onClick:C},t[2]||(t[2]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"var(--Text-color)",width:"18",height:"18",viewBox:"0 0 24 24"},[a("path",{d:"M16.5 6a3 3 0 0 0-4.15 0L7 11.4a1.75 1.75 0 0 0 2.46 2.46l4.95-4.95a1.25 1.25 0 1 1 1.76 1.76l-5.65 5.66a3.75 3.75 0 1 1-5.3-5.3L11.2 5.1a5 5 0 0 1 7.08 7.07l-6.3 6.3a6.25 6.25 0 0 1-8.83-8.83l7.2-7.2a3.75 3.75 0 0 1 5.3 5.3L9.25 15.3"})],-1)])),a("input",{type:"file",class:"hidden",ref_key:"fileInputRef",ref:m,onChange:I},null,544),a("button",{type:"button",class:"emojiButton",onClick:P}," ðŸ˜Š ")])])):(n(),D(i,{key:1}))])}}});export{oe as default};
