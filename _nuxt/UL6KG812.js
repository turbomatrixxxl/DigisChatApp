import{g as R,j as U,r as c,k,l as D,m as S,n as B,p as M,q as A,c as s,o as a,s as j,a as n,v as _,F as m,x as N,t as r,y as $,z as F,A as O,B as E,C as V}from"./iXAAY-EJ.js";const K={key:0,class:"chatPage"},W={class:"messageList"},z={class:"msgOutboxContent"},Z={key:0,class:"filePreview"},q=["src"],Y=["href"],G={class:"timestampOutbox"},H={class:"msgInboxContent"},J={key:0,class:"filePreview"},Q=["src"],X=["href"],ee={class:"timestampInbox"},te={key:0,class:"filePreview"},ae=["src"],se={key:1},ne={class:"sendMsgCont"},oe=["onKeydown"],ue=R({__name:"[chatId]",setup(ie){U().push("/chat");const o=c(null),y=c(null);c(null);const b=k(()=>o.value?(window.URL||window.webkitURL).createObjectURL(o.value):void 0),p=D(),w=S().params.chatId,u=c(""),v=c(!1),x=c(!1),h=k(()=>p.selectChatById(w)??null);B(async()=>{h.value||await p.fetchData(),await M(()=>import("./DUTOXKKD.js"),[],import.meta.url),x.value=!0});function g(i){let t=new Date(i);if(isNaN(t.getTime())){const L=i.replace(/(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}):(\d{2})\.(\d{3})Z$/,"$1:59.$3Z");t=new Date(L)}if(isNaN(t.getTime()))return"";t.getSeconds()>59&&t.setSeconds(59);const l=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e=t.getDate(),d=t.toLocaleString("default",{month:"long"}),f=t.getFullYear();return`${e} ${d} ${f}-${l}`}function C(){var e;if(!u.value.trim()&&!o.value)return;const i=u.value.trim(),t=typeof window<"u"&&o.value?URL.createObjectURL(o.value):null,l=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():Date.now().toString();p.updateChat({chatId:w,newMessages:[{id:l,content:i,file:t??void 0,fileType:((e=o.value)==null?void 0:e.type)??void 0,isInbox:!1,sentAt:new Date().toISOString()}]}),u.value="",v.value=!1,o.value=null}function I(){var i;(i=y.value)==null||i.click()}function P(i){var e;const l=((e=i.target.files)==null?void 0:e[0])??null;l&&(o.value=l)}function T(){v.value=!v.value}return(i,t)=>{const l=A("IndexPage");return a(),s("div",null,[h.value?(a(),s("div",K,[n("ul",W,[(a(!0),s(m,null,N(h.value.messages,e=>{var d,f;return a(),s("li",{key:e.id,class:V([e.isInbox?"outbox":"inbox"])},[e.isInbox?(a(),s(m,{key:0},[t[1]||(t[1]=n("span",{class:"ownerName"},"Radu Bogdan",-1)),n("span",z,r(e.content),1),e.file?(a(),s("span",Z,[(d=e.fileType)!=null&&d.startsWith("image/")?(a(),s("img",{key:0,src:e.file,alt:"Preview",class:"imagePreview"},null,8,q)):(a(),s("a",{key:1,href:e.file,target:"_blank"},r(e.file),9,Y))])):_("",!0),n("span",G,r(e.sentAt?g(e.sentAt):"Time not available"),1)],64)):(a(),s(m,{key:1},[n("span",H,r(e.content),1),e.file?(a(),s("span",J,[(f=e.fileType)!=null&&f.startsWith("image/")?(a(),s("img",{key:0,src:e.file,alt:"Preview",class:"imagePreview"},null,8,Q)):(a(),s("a",{key:1,href:e.file,target:"_blank"},r(e.file),9,X))])):_("",!0),n("span",ee,r(e.sentAt?g(e.sentAt):"Time not available"),1)],64))],2)}),128)),o.value?(a(),s("li",te,[o.value.type.startsWith("image/")?(a(),s("img",{key:0,src:b.value,alt:"File Preview",class:"imagePreview"},null,8,ae)):(a(),s("span",se,r(o.value.name),1))])):_("",!0)]),n("div",ne,[$(n("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),type:"text",placeholder:"Type something here...",class:"sendMsgInput",onKeydown:O(E(C,["prevent"]),["enter"])},null,40,oe),[[F,u.value]]),n("button",{type:"button",class:"writeMsgButton",onClick:I},t[2]||(t[2]=[n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"var(--Text-color)",width:"18",height:"18",viewBox:"0 0 24 24"},[n("path",{d:"M16.5 6a3 3 0 0 0-4.15 0L7 11.4a1.75 1.75 0 0 0 2.46 2.46l4.95-4.95a1.25 1.25 0 1 1 1.76 1.76l-5.65 5.66a3.75 3.75 0 1 1-5.3-5.3L11.2 5.1a5 5 0 0 1 7.08 7.07l-6.3 6.3a6.25 6.25 0 0 1-8.83-8.83l7.2-7.2a3.75 3.75 0 0 1 5.3 5.3L9.25 15.3"})],-1)])),n("input",{type:"file",class:"hidden",ref_key:"fileInputRef",ref:y,onChange:P},null,544),n("button",{type:"button",class:"emojiButton",onClick:T}," ðŸ˜Š ")])])):(a(),j(l,{key:1}))])}}});export{ue as default};
